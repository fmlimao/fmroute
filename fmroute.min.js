var FMRoute=function(){function t(){this.routes=[],this.previous_route=null,this.current_route=null,this.default_callback={404:function(t,e,r){console.dir(r+": 404 NOT FOUND"),e()},before:function(t,e,r){e()},after:function(t,e){}}}return t.prototype={get:function(t,e,r){e=e||function(t,e){e()},r=r||function(t,e){e()},t=this.clearPath(t),path_elements=this.splitPath(t),t="/"+t;var n={path:t,path_elements:path_elements,callback_enter:e,callback_exit:r};this.routes.push(n)},run:function(){this.startHashListener(),this.getCurrentHash()},startHashListener:function(){var t=this;window.addEventListener("hashchange",function(){t.getCurrentHash()},!1)},getCurrentHash:function(){var t=window.location.hash;""==t?window.location.hash="/":(this.changePreviousCurrentRoute(t),this.executeRoutes())},executeRoutes:function(){var t=this,e=this.default_callback.before,r=this.default_callback.after,n=this.getExitCallback(),i=this.getEnterCallback();e(i[1],function(){n[0](n[1],function(){i[0](i[1],function(){r(i[1],t.current_route)},t.current_route)})},t.current_route)},clearPath:function(t){return t=t.trim(),t=t.replace("#",""),t=t.toLowerCase(),"/"==t.substring(0,1)&&(t=t.substring(1)),"/"==t.slice(-1)&&(t=t.slice(0,-1)),t},splitPath:function(t){return t=t.split("/")},changePreviousCurrentRoute:function(t){this.previous_route=this.current_route,this.current_route=t},getExitCallback:function(){var t=function(t,e){e()},e={};if(this.previous_route){var r=this.checkPathExists(this.previous_route);r&&(t=r[0].callback_exit,e=r[1])}return[t,e]},getEnterCallback:function(){var t=this.default_callback[404],e={};if(this.current_route){var r=this.checkPathExists(this.current_route);r&&(t=r[0].callback_enter,e=r[1])}return[t,e]},checkPathExists:function(t){var e=this.clearPath(t);e=this.splitPath(e);var r=null,n=this.routes;for(var i in n){var a=n[i];if(a.path_elements.length==e.length){var u=!0,s={};for(var c in a.path_elements){var o=a.path_elements[c],h=this.isPathVar(o);h?s[h]=e[c]:o!=e[c]&&(u=!1)}if(u){r=[a,s];break}}}return r},isPathVar:function(t){return":"==t.substring(0,1)&&t.substring(1)},error:function(t,e){this.default_callback[t]=e},before:function(t){this.default_callback.before=t},after:function(t){this.default_callback.after=t}},t}();